FIRST QUERY(First slide in presentation)

/* Write a query that helps to conclude what is percentage of following two categories of movies that people watch?
  'FAMILY MOVIES' :-  Animation,children,classics,comedy,family,music
  'OTHER MOVIES' :-  rest of the categories other than those in 'FAMILY MOVIES'. */

SELECT movie_type, 
       SUM(rental_count) rental_count
  FROM (
	SELECT film_name,
               film_category, 
               movie_type,
               COUNT(rental_date) rental_count
          FROM (
                SELECT c.name film_category,
		       f.title film_name,
		       r.rental_date, 
                       CASE WHEN c.name IN ('Animation', 'Children', 'Classics', 'Comedy', 'Family', 'Music') 
		       THEN 'Family movie' ELSE 'Other movie' END AS movie_type	
	   	  FROM category c
 	   	  JOIN film_category fc
	     	    ON c.category_id = fc.category_id
          	  JOIN film f
           	    ON f.film_id = fc.film_id
     	   	  JOIN inventory i            
    	    	    ON f.film_id = i.film_id  
      	  	  JOIN rental r
           	    ON r.inventory_id = i.inventory_id
	 	) t1
      GROUP BY 2,1,3
	) t2
 GROUP BY 1;


************************************************************************************************************
